{% extends "base_generic.html" %}

{% block title %}Super Admin - Dashboard{% endblock %}

{% block content %}
<div class="container-fluid mt-4">
    <h1>üöÄ Super Admin Dashboard</h1>
    <p class="lead">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ SaaS –ø–ª–∞—Ç—Ñ–æ—Ä–º–æ–π</p>
    
    <hr>
    
    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
    <div class="row mb-4">
        <div class="col-md-3">
            <div class="card bg-primary text-white">
                <div class="card-body">
                    <h5 class="card-title">–ö–æ–º–ø–∞–Ω–∏–π</h5>
                    <h2>{{ stats.total_companies }}</h2>
                    <small>–ê–∫—Ç–∏–≤–Ω—ã—Ö: {{ stats.active_companies }}</small>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card bg-success text-white">
                <div class="card-body">
                    <h5 class="card-title">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h5>
                    <h2>{{ stats.total_users }}</h2>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card bg-info text-white">
                <div class="card-body">
                    <h5 class="card-title">–°–∏—Å—Ç–µ–º</h5>
                    <h2>{{ stats.total_systems }}</h2>
                    <small>–û–±—ä–µ–∫—Ç–æ–≤: {{ stats.total_objects }}</small>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card bg-warning text-white">
                <div class="card-body">
                    <h5 class="card-title">–î–æ—Ö–æ–¥/–º–µ—Å</h5>
                    <h2>${{ stats.total_revenue_monthly|floatformat:0 }}</h2>
                </div>
            </div>
        </div>
    </div>
    
    <!-- –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è -->
    <div class="row mb-4">
        <div class="col-md-12">
            <div class="btn-group" role="group">
                <a href="{% url 'superadmin:company_list' %}" class="btn btn-primary">
                    <i class="fas fa-building"></i> –í—Å–µ –∫–æ–º–ø–∞–Ω–∏–∏
                </a>
                <a href="{% url 'superadmin:subscription_list' %}" class="btn btn-success">
                    <i class="fas fa-credit-card"></i> –ü–æ–¥–ø–∏—Å–∫–∏
                </a>
                <a href="{% url 'superadmin:invoice_list' %}" class="btn btn-warning">
                    <i class="fas fa-file-invoice-dollar"></i> –°—á–µ—Ç–∞
                </a>
                <a href="{% url 'superadmin:statistics' %}" class="btn btn-info">
                    <i class="fas fa-chart-line"></i> –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
                </a>
            </div>
        </div>
    </div>
    
    <!-- –ü–æ—Å–ª–µ–¥–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏ -->
    <div class="row">
        <div class="col-md-6">
            <div class="card">
                <div class="card-header">
                    <h5>üìù –ü–æ—Å–ª–µ–¥–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏</h5>
                </div>
                <div class="card-body">
                    <table class="table table-sm">
                        <thead>
                            <tr>
                                <th>–ö–æ–º–ø–∞–Ω–∏—è</th>
                                <th>Email</th>
                                <th>–°—Ç–∞—Ç—É—Å</th>
                                <th>–°–æ–∑–¥–∞–Ω–∞</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for company in recent_companies %}
                            <tr>
                                <td>
                                    <a href="{% url 'superadmin:company_detail' company.pk %}">
                                        {{ company.name }}
                                    </a>
                                </td>
                                <td>{{ company.contact_email }}</td>
                                <td>
                                    {% if company.subscription_status == 'active' %}
                                        <span class="badge badge-success">–ê–∫—Ç–∏–≤–Ω–∞</span>
                                    {% elif company.subscription_status == 'trial' %}
                                        <span class="badge badge-warning">–¢—Ä–∏–∞–ª</span>
                                    {% else %}
                                        <span class="badge badge-danger">{{ company.get_subscription_status_display }}</span>
                                    {% endif %}
                                </td>
                                <td>{{ company.created_at|date:"d.m.Y" }}</td>
                            </tr>
                            {% empty %}
                            <tr>
                                <td colspan="4" class="text-center">–ù–µ—Ç –∫–æ–º–ø–∞–Ω–∏–π</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <div class="col-md-6">
            <div class="card">
                <div class="card-header">
                    <h5>‚ö†Ô∏è –ò—Å—Ç–µ–∫–∞—é—â–∏–µ –ø–æ–¥–ø–∏—Å–∫–∏</h5>
                </div>
                <div class="card-body">
                    <table class="table table-sm">
                        <thead>
                            <tr>
                                <th>–ö–æ–º–ø–∞–Ω–∏—è</th>
                                <th>–ò—Å—Ç–µ–∫–∞–µ—Ç</th>
                                <th>–û—Å—Ç–∞–ª–æ—Å—å</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for company in expiring_soon %}
                            <tr>
                                <td>
                                    <a href="{% url 'superadmin:company_detail' company.pk %}">
                                        {{ company.name }}
                                    </a>
                                </td>
                                <td>{{ company.subscription_expires_at|date:"d.m.Y" }}</td>
                                <td>
                                    <span class="badge badge-danger">
                                        {{ company.days_until_expiration }} –¥–Ω.
                                    </span>
                                </td>
                            </tr>
                            {% empty %}
                            <tr>
                                <td colspan="3" class="text-center">–ù–µ—Ç –∏—Å—Ç–µ–∫–∞—é—â–∏—Ö –ø–æ–¥–ø–∏—Å–æ–∫</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
