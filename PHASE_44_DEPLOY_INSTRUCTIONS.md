# üéÆ PHASE 4.4: ACTUATORS & CONTROL - –ò–ù–°–¢–†–£–ö–¶–ò–Ø –ü–û –î–ï–ü–õ–û–Æ

## ‚úÖ –®–ê–ì 1: PUSH –ù–ê GITHUB

**Commit —É–∂–µ —Å–æ–∑–¥–∞–Ω –ª–æ–∫–∞–ª—å–Ω–æ:**
```
Commit: 2cf5349
Message: üéÆ Phase 4.4 MVP: Actuators & Basic Control System
```

**–§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã:**
- ‚úÖ `data/models.py` - –¥–æ–±–∞–≤–ª–µ–Ω—ã –º–æ–¥–µ–ª–∏ Actuator –∏ ActuatorCommand
- ‚úÖ `data/admin.py` - —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π
- ‚úÖ `data/urls.py` - URL routing –¥–ª—è –∞–∫—Ç—É–∞—Ç–æ—Ä–æ–≤
- ‚úÖ `data/views_actuators.py` - 3 view —Ñ—É–Ω–∫—Ü–∏–∏ (list, control, history)
- ‚úÖ `data/migrations/0012_phase_44_actuators.py` - –º–∏–≥—Ä–∞—Ü–∏—è –ë–î
- ‚úÖ `templates/data/actuators_list.html` - –≥–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- ‚úÖ `templates/data/actuator_history.html` - –∏—Å—Ç–æ—Ä–∏—è –∫–æ–º–∞–Ω–¥
- ‚úÖ `templates/data/object_list.html` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∫–Ω–æ–ø–∫–∞ "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ"
- ‚úÖ `templates/data/all_systems.html` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∫–Ω–æ–ø–∫–∞ "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ"
- ‚úÖ `templates/data/alerts_list.html` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∫–Ω–æ–ø–∫–∞ "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ"
- ‚úÖ `data/management/commands/create_demo_actuators.py` - –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è –¥–µ–º–æ –¥–∞–Ω–Ω—ã—Ö

**–í—ã–ø–æ–ª–Ω–∏—Ç–µ push –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ GitHub Desktop –∏–ª–∏ –∫–æ–º–∞–Ω–¥–æ–π:**

```bash
cd ~/promonitor
git push origin main
```

---

## ‚úÖ –®–ê–ì 2: RAILWAY AUTO-DEPLOY

Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—á–Ω—ë—Ç –¥–µ–ø–ª–æ–π –ø–æ—Å–ª–µ push.

**–ü—Ä–æ—Ü–µ—Å—Å (5-7 –º–∏–Ω—É—Ç):**
1. ‚è≥ Railway –æ–±–Ω–∞—Ä—É–∂–∏—Ç –Ω–æ–≤—ã–π commit
2. üèóÔ∏è Build –ø—Ä–æ—Ü–µ—Å—Å (install dependencies)
3. üì¶ –°–æ–∑–¥–∞–Ω–∏–µ Docker –æ–±—Ä–∞–∑–∞
4. üöÄ Deploy –Ω–∞ production
5. üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

**–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ:**
- https://railway.app/project/[your-project-id]/deployments

---

## ‚úÖ –®–ê–ì 3: –ó–ê–ü–£–°–ö –ú–ò–ì–†–ê–¶–ò–ò –ë–î

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é:

```bash
# –í Railway Dashboard ‚Üí Deployments ‚Üí Latest ‚Üí Shell
python manage.py migrate
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
Running migrations:
  Applying data.0012_phase_44_actuators... OK
```

---

## ‚úÖ –®–ê–ì 4: –°–û–ó–î–ê–ù–ò–ï –î–ï–ú–û –î–ê–ù–ù–´–•

–ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –∞–∫—Ç—É–∞—Ç–æ—Ä–æ–≤:

```bash
python manage.py create_demo_actuators
```

**–ß—Ç–æ –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω–æ:**
- 10 –∞–∫—Ç—É–∞—Ç–æ—Ä–æ–≤ —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ (–∫–ª–∞–ø–∞–Ω—ã, —Ä–µ–ª–µ, –Ω–∞—Å–æ—Å—ã, –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä—ã, –º–æ—Ç–æ—Ä—ã, –Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª–∏)
- 50-150 –∫–æ–º–∞–Ω–¥ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–∏—Å—Ç–æ—Ä–∏—è —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏)
- –°—Ç–∞—Ç—É—Å: 75% —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –æ–Ω–ª–∞–π–Ω
- –£—Å–ø–µ—à–Ω–æ—Å—Ç—å –∫–æ–º–∞–Ω–¥: ~95%

---

## ‚úÖ –®–ê–ì 5: –ü–†–û–í–ï–†–ö–ê –†–ê–ë–û–¢–û–°–ü–û–°–û–ë–ù–û–°–¢–ò

### 5.1. –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
```
https://www.promonitor.kz/data/actuators/
```

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:**
- ‚úÖ –ö–∞—Ä—Ç–æ—á–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (–≤—Å–µ–≥–æ, –æ–Ω–ª–∞–π–Ω, –∞–∫—Ç–∏–≤–Ω—ã—Ö, –∫–æ–º–∞–Ω–¥—ã –∑–∞ 24—á)
- ‚úÖ –§–∏–ª—å—Ç—Ä—ã (—Ç–∏–ø —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞, –æ–±—ä–µ–∫—Ç, —Å—Ç–∞—Ç—É—Å, –ø–æ–∏—Å–∫)
- ‚úÖ –°–ø–∏—Å–æ–∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ —Å —Ç–µ–∫—É—â–∏–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
- ‚úÖ –ö–Ω–æ–ø–∫–∏ "üéÆ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ" –∏ "üìä –ò—Å—Ç–æ—Ä–∏—è"

### 5.2. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ–º

**–ë–∏–Ω–∞—Ä–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (—Ä–µ–ª–µ, –Ω–∞—Å–æ—Å—ã, –≤—ã–∫–ª—é—á–∞—Ç–µ–ª–∏):**
- –ù–∞–∂–º–∏—Ç–µ "üéÆ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ"
- –î–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è –∫–Ω–æ–ø–∫–∏ "‚≠ï –í–´–ö–õ" –∏ "üü¢ –í–ö–õ"
- –ù–∞–∂–º–∏—Ç–µ –ª—é–±—É—é –∫–Ω–æ–ø–∫—É
- –ó–Ω–∞—á–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å—Å—è
- –î–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ "‚úÖ –ö–æ–º–∞–Ω–¥–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞"

**–ê–Ω–∞–ª–æ–≥–æ–≤—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (–∫–ª–∞–ø–∞–Ω—ã, –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä—ã, –º–æ—Ç–æ—Ä—ã):**
- –ù–∞–∂–º–∏—Ç–µ "üéÆ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ"
- –î–æ–ª–∂–µ–Ω –ø–æ—è–≤–∏—Ç—å—Å—è –ø–æ–ª–∑—É–Ω–æ–∫ (0-100%)
- –ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –ø–æ–ª–∑—É–Ω–æ–∫
- –ù–∞–∂–º–∏—Ç–µ "‚úÖ –í—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—É"
- –ó–Ω–∞—á–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å—Å—è

### 5.3. –ò—Å—Ç–æ—Ä–∏—è –∫–æ–º–∞–Ω–¥
```
https://www.promonitor.kz/data/actuators/{id}/history/
```

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:**
- ‚úÖ –ö–∞—Ä—Ç–æ—á–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (–≤—Å–µ–≥–æ –∫–æ–º–∞–Ω–¥, —É—Å–ø–µ—à–Ω—ã—Ö, –æ—à–∏–±–æ–∫, —É—Å–ø–µ—à–Ω–æ—Å—Ç—å %)
- ‚úÖ –¢–∞–±–ª–∏—Ü–∞ –∏—Å—Ç–æ—Ä–∏–∏ –∫–æ–º–∞–Ω–¥
- ‚úÖ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–∞–∂–¥–æ–π –∫–æ–º–∞–Ω–¥–µ (–≤—Ä–µ–º—è, –∑–Ω–∞—á–µ–Ω–∏–µ, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, —Å—Ç–∞—Ç—É—Å, –æ—Ç–∫–ª–∏–∫)

### 5.4. –ù–∞–≤–∏–≥–∞—Ü–∏—è

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–Ω–æ–ø–∫—É "üéÆ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ" –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö:**
- ‚úÖ `/objects/` - —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –æ–±—ä–µ–∫—Ç–æ–≤
- ‚úÖ `/systems/` - —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å–∏—Å—Ç–µ–º
- ‚úÖ `/alerts/` - —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Ç—Ä–µ–≤–æ–≥

---

## üìä –ê–†–•–ò–¢–ï–ö–¢–£–†–ê

### –ú–æ–¥–µ–ª–∏:

```python
Actuator:
  - sys (ForeignKey ‚Üí System)
  - name, description
  - actuator_type (valve/relay/pump/fan/motor/heater/switch/dimmer/cooler)
  - modbus_carel, register, carel_reg, register_type
  - min_value, max_value, default_value, current_value
  - last_command_at
  - is_active, is_online

ActuatorCommand:
  - actuator (ForeignKey ‚Üí Actuator)
  - command_value
  - user (ForeignKey ‚Üí User_profile)
  - executed_at
  - status (pending/success/failed/timeout)
  - response_time_ms
  - error_message, notes
  - source_ip
```

### URLs:

```
/data/actuators/                           - —Å–ø–∏—Å–æ–∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤
/data/actuators/<id>/control/              - –æ—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–º–∞–Ω–¥—ã (POST)
/data/actuators/<id>/history/              - –∏—Å—Ç–æ—Ä–∏—è –∫–æ–º–∞–Ω–¥
```

### Views:

```python
actuators_list(request)          - –≥–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏
actuator_control(request, id)    - POST handler –¥–ª—è –∫–æ–º–∞–Ω–¥
actuator_history(request, id)    - –∏—Å—Ç–æ—Ä–∏—è –∫–æ–º–∞–Ω–¥ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
```

---

## üöÄ –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò (–ë–£–î–£–©–ò–ï –£–õ–£–ß–®–ï–ù–ò–Ø)

**–ü–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –±–∞–∑–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å:**

1. **–†–µ–∞–ª—å–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Modbus:**
   - –û—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–º–∞–Ω–¥ –Ω–∞ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã CAREL
   - –ß—Ç–µ–Ω–∏–µ —Ç–µ–∫—É—â–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å–≤—è–∑–∏

2. **WebSocket –¥–ª—è real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π:**
   - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
   - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∫–æ–º–∞–Ω–¥–∞—Ö –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

3. **–ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞:**
   - –†–æ–ª–∏: viewer (—Ç–æ–ª—å–∫–æ –ø—Ä–æ—Å–º–æ—Ç—Ä), operator (—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ), admin (–≤—Å–µ)
   - –ê—É–¥–∏—Ç –¥–µ–π—Å—Ç–≤–∏–π

4. **–°—Ü–µ–Ω–∞—Ä–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
   - –ì—Ä—É–ø–ø–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã (—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏)
   - –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≤ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–µ –≤—Ä–µ–º—è)
   - –£—Å–ª–æ–≤–∏—è (–µ—Å–ª–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ > 25¬∞C, —Ç–æ –≤–∫–ª—é—á–∏—Ç—å –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä)

5. **–ì—Ä–∞—Ñ–∏–∫–∏ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞:**
   - –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π
   - –ß–∞—Å—Ç–æ—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
   - –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞

---

## ‚ùì TROUBLESHOOTING

### –ü—Ä–æ–±–ª–µ–º–∞: –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
```bash
python manage.py showmigrations
python manage.py migrate data 0012_phase_44_actuators
```

### –ü—Ä–æ–±–ª–µ–º–∞: –°—Ç—Ä–∞–Ω–∏—Ü–∞ 404

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:**
```bash
python manage.py show_urls | grep actuators
```

### –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:**
```bash
python manage.py check
```

### –ü—Ä–æ–±–ª–µ–º–∞: –î–µ–º–æ –¥–∞–Ω–Ω—ã–µ –Ω–µ —Å–æ–∑–¥–∞—é—Ç—Å—è

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ –¥–∞–Ω–Ω—ã—Ö:**
```bash
python manage.py shell
>>> from data.models import Company, System
>>> Company.objects.count()
>>> System.objects.count()
```

---

## ‚úÖ CHECKLIST –î–ï–ü–õ–û–Ø

- [ ] Git push –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ
- [ ] Railway deployment –∑–∞–≤–µ—Ä—à—ë–Ω (—Å—Ç–∞—Ç—É—Å: Success)
- [ ] –ú–∏–≥—Ä–∞—Ü–∏—è –ë–î –ø—Ä–∏–º–µ–Ω–µ–Ω–∞
- [ ] –î–µ–º–æ –¥–∞–Ω–Ω—ã–µ —Å–æ–∑–¥–∞–Ω—ã
- [ ] –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ `/actuators/` –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è
- [ ] –ö–∞—Ä—Ç–æ—á–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- [ ] –§–∏–ª—å—Ç—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç
- [ ] –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∏–Ω–∞—Ä–Ω—ã–º–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–Ω–∞–ª–æ–≥–æ–≤—ã–º–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –ò—Å—Ç–æ—Ä–∏—è –∫–æ–º–∞–Ω–¥ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è
- [ ] –ù–∞–≤–∏–≥–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö
- [ ] Admin –ø–∞–Ω–µ–ª—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–æ–≤—ã–µ –º–æ–¥–µ–ª–∏

---

**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —à–∞–≥–æ–≤: ~15-20 –º–∏–Ω—É—Ç**

**–ì–æ—Ç–æ–≤–æ –∫ production! üöÄ**
